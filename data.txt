Running a sim of EM wave propagation along a two-wire transmission line (TWTL), I found a possible bug in gprMax v.4.0.0b0 (or possibly some misuse by me of the new API). The v4 sim exhibits non-physical asymmetry, while the same sim in v.3.1.7 is perfectly symmetric as expected.

The main sim domain is ~150mm long by about 40x40mm and has 1mm cells. A pair of parallel 1mm-thick PEC lines 11mm apart models the TWTL; these lines are bent at 90º at each end to bring them together at 1mm-wide transmission line inputs. One input provides a continuous sine ±1V source at 400MHz (50Ω); the other dummy input is set at 0V. (An alternative setup using voltage sources and receivers behaves in a similar manner). The ambient medium is 1-pole Debye water in a PMMA box 5mm thick, with PML beyond. Therefore the sim generates a ~TEM wave that initiates at the source, propagates along the parallel "wires", and should set up a steadily varying EM field perfectly symmetric about the centre line between them.

\

The sim runs for 500ns with ~0.5ns time steps. As you can see from the pic here (at time 250ns), the Ez field component reveals unexpected asymmetry in the v4 sim, whereas the v3 sim behaves as we would expect (visualization in ParaView 5.12). There's also a strong E-field at places within the PEC in v4 but not in v3.

It's possible that I have set up the v4 sim incorrectly, but it's not at all obvious to me how. I'm attaching here the v3 .in file and the v4 .py file (which exploits the new pure-Python API). If I have accidentally introduced an asymmetry, could someone please show me where?

I'm going to try to supply a video of both 500ns sims in a follow up post.

Any help would be much appreciated!
Thanks,
Colin




Next CommentHere's the video

Next CommentHi Colin,

Thanks - this is a really useful comparison - can you file it on our GitHub issue tracker please. It will take me a while to dig into the detail of your model and check the v3/v4 behaviour differences. If you have time can you try to create a minimum working example that shows the potential issue, e.g. one of the first things would be to remove the water and eliminate any potential issue from the dispersive materials. You could also plot the specific source output in case it is some sort of issue with the source definition. As I say, I will get to looking at this, but it may take a while.

Kind regards,
Craig

Next CommentCraig,

Yeah, it makes sense to simplify it a bit and plot the inputs and outputs. I'll get to that tomorrow.

Colin

Next CommentCraig,

I posted an issue on GitHub after testing with a simplified pair of input files. The behaviour is unchanged.
      https://github.com/gprMax/gprMax/issues/433

I've also included plots of the TL source input voltage and TL output total voltage – for both the v3 and v4 sims. You'll see that the v4 output oscillates in a non-physical way, while the v3 output is stable.

Good luck with tracking down the origin of this problem! I hope it's just me doing something wrong in v4, but I suspect it's not.

Cheers,
Colin

Next Comment